schema_version: 1

# input_dim = sum of all flattened noise_processor outputs (no action term):
#   depth:  output_depth_channel * Hd * Wd  = 24 * 16 * 16 = 6144
#   head:   output_img_channel * H' * W'    = 24 * 14 * 14 = 4704
#   left:                                   = 24 * 14 * 14 = 4704
#   right:                                  = 24 * 14 * 14 = 4704
#   proprio: obs_history * obs_dim          = 40 * 24       = 960
#   total:                                              = 21216
# Adjust if your camera resolution differs from 224x224.

params:
  input_dim: 21216
  action_chunk_size: 50
  action_dim: 24
  num_layers: 3
  num_hidden_dim: 2048
  dropout: 0.0

model:
  graph:
    inputs: [flat_features]
    modules:
      actor:
        _type_: dsrl_noise_latent_actor
        input_dim: ${params.input_dim}
        action_chunk_size: ${params.action_chunk_size}
        action_dim: ${params.action_dim}
        num_layers: ${params.num_layers}
        num_hidden_dim: ${params.num_hidden_dim}
        dropout: ${params.dropout}
    nodes:
      - name: noise
        call: module:actor
        kwargs:
          flattened_tensor: $flat_features
    outputs: [$noise]
    return: single
