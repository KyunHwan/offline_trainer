schema_version: 1

params:
  cond_proprio_dim: 48
  cond_visual_dim: 1024
  use_cond_semantic: true
  use_cond_semantic_projection: true
  cond_semantic_dim: 3072
  use_cls_token: false
  num_cls_token: 1
  use_action: false
  action_dim: null
  num_cond_semantic: 3
  num_cond_visuals: 4

  transformer_d_model: 512

model:
  graph:
    inputs: [cond_proprio, cond_visual, cond_semantic, action]
    modules:
      multimodal_bridge:
        _type_: vfp_single_multimodal_bridge
        cond_proprio_dim: ${params.cond_proprio_dim}
        cond_visual_dim: ${params.cond_visual_dim}
        transformer_d_model: ${params.transformer_d_model}
        action_dim: ${params.action_dim}
        use_action: ${params.use_action}
        use_cond_semantic: ${params.use_cond_semantic}
        use_cond_semantic_projection: ${params.use_cond_semantic_projection}
        cond_semantic_dim: ${params.cond_semantic_dim}
        use_cls_token: ${params.use_cls_token}
        num_cls_token: ${params.num_cls_token}
        num_cond_semantic: ${params.num_cond_semantic}
        num_cond_visuals: ${params.num_cond_visuals}
    nodes:
      - name: multimodal_bridge
        call: module:multimodal_bridge
        kwargs:
          cond_proprio: $cond_proprio
          cond_visual: $cond_visual
          cond_semantic: $cond_semantic
          action: $action
    outputs: [$multimodal_bridge]
    return: single
